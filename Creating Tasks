CREATE OR REPLACE DATABASE TASK_DB;

CREATE OR REPLACE TABLE TAKS_CREATION(
ID NUMBER AUTOINCREMENT START 1 increment 1,
NAME STRING DEFAULT 'SNOW',
CREATE_DATE DATE
);


CREATE OR REPLACE TASK COMPUTE_TASK
WAREHOUSE = COMPUTE_WH
SCHEDULE = '1 MINUTE'
AS
INSERT INTO TAKS_CREATION(CREATE_DATE) values(CURRENT_TIMESTAMP);


SHOW TASKS;

ALTER TASK COMPUTE_TASK RESUME;

SELECT * FROM TAKS_CREATION;
ALTER TASK COMPUTE_TASK SUSPEND;


CREATE OR REPLACE TABLE TAKS_CREATION1(
ID NUMBER AUTOINCREMENT START 1 increment 1,
NAME STRING DEFAULT 'SNOW',
CREATE_DATE DATE
);

CREATE OR REPLACE TABLE TAKS_CREATION2(
ID NUMBER AUTOINCREMENT START 1 increment 1,
NAME STRING DEFAULT 'SNOW',
CREATE_DATE DATE
);


CREATE Or REPLACE TASK COMPUTE_TASK1
WAREHOUSE = COMPUTE_WH
SCHEDULE = '1 MINUTE'
AS 
INSERT INTO TAKS_CREATION1 SELECT * FROM TAKS_CREATION;


CREATE Or REPLACE TASK COMPUTE_TASK2
WAREHOUSE = COMPUTE_WH
SCHEDULE = '1 MINUTE'
AS 
INSERT INTO TAKS_CREATION2 SELECT * FROM TAKS_CREATION1;

SHOW TASKS;


ALTER TASK COMPUTE_TASK RESUME;
ALTER TASK COMPUTE_TASK1 RESUME;
ALTER TASK COMPUTE_TASK2 RESUME;


SELECT * FROM TAKS_CREATION;
SELECT * FROM TAKS_CREATION1;
SELECT * FROM TAKS_CREATION2;

ALTER TASK COMPUTE_TASK SUSPEND;
ALTER TASK COMPUTE_TASK1 SUSPEND;
ALTER TASK COMPUTE_TASK2 SUSPEND;




